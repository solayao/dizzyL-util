"use strict";var _require=require("./config.json"),baseUrl=_require.baseUrl,basePort=_require.basePort,basePath=_require.basePath;function _checkStatus(e){if(e.status>=200&&e.status<300)return e;var t=new Error(e.statusText);throw t.response=e,t}function _parseJSON(e){return e?e.json():void 0}function _parseText(e){return e?e.text():void 0}function _fetchWithCORS(e,t,o){return fetch(e,{mode:"cors",credentials:"include",headers:Object.assign({},o)}).then(_checkStatus).then("json"===t?_parseJSON:_parseText).catch(function(e){return console.log(e)})}function _get(e){var t=e.base_url,o=void 0===t?baseUrl:t,r=e.port,a=void 0===r?basePort:r,n=e.path,i=void 0===n?basePath:n,s=e.action,u=void 0===s?"GET":s,c=e.contentType,d=void 0===c?"json":c,v=e.contentHeader,h=void 0===v?{}:v,b=e.url;return _fetchWithCORS(""+(b||o+":"+a)+i+"?action="+u,d,h)}function _getWithQueryParams(e){var t=e.base_url,o=void 0===t?baseUrl:t,r=e.port,a=void 0===r?basePort:r,n=e.path,i=void 0===n?basePath:n,s=e.requestParams,u=void 0===s?{}:s,c=e.action,d=void 0===c?"GET":c,v=e.contentType,h=void 0===v?"json":v,b=e.contentHeader,p=void 0===b?{}:b,_=e.url,f="";for(var l in u)f+=l+"="+encodeURIComponent(u[l])+"&";return _fetchWithCORS(""+(_||o+":"+a)+i+"?"+f+"action="+d,h,p)}function _getWithRequestData(e){var t=e.base_url,o=void 0===t?baseUrl:t,r=e.port,a=void 0===r?basePort:r,n=e.path,i=void 0===n?basePath:n,s=e.requestParams,u=void 0===s?{}:s,c=e.action,d=void 0===c?"GET":c,v=e.contentType,h=void 0===v?"json":v,b=e.contentHeader,p=void 0===b?{}:b,_=e.url;return _fetchWithCORS(""+(_||o+":"+a)+i+"?requestData="+encodeURIComponent(JSON.stringify(u))+"&action="+d,h,p)}function _postWithRequestData(e){var t=e.base_url,o=void 0===t?baseUrl:t,r=e.port,a=void 0===r?basePort:r,n=e.path,i=void 0===n?basePath:n,s=e.requestParams,u=void 0===s?{}:s,c=e.action,d=void 0===c?"POST":c,v=e.contentType,h=void 0===v?"json":v,b=e.contentHeader,p=void 0===b?{}:b,_=e.url;return _fetchWithCORS(""+(_||o+":"+a)+i+"?requestData="+encodeURIComponent(JSON.stringify(u))+"&action="+d,h,p)}module.exports=function(e){var t=e.base_url,o=void 0===t?baseUrl:t,r=e.port,a=void 0===r?basePort:r,n=e.path,i=void 0===n?basePath:n,s=e.timeout,u=void 0===s?12e4:s,c=e.fetchType,d=void 0===c?"get":c,v=e.requestParams,h=void 0===v?{}:v,b=e.contentType,p=void 0===b?"json":b,_=e.url,f=void 0,l=void 0,P={base_url:o,port:a,url:_,path:i,requestParams:h,contentType:p};switch(d){case"get":l=_get(P);break;case"getByQuery":l=_getWithQueryParams(P);break;case"getByRequest":l=_getWithRequestData(P);break;case"post":l=_postWithRequestData(P);break;default:l=fetch(o+":"+a+i,{})}return Promise.race([new Promise(function(e,t){f=setTimeout(function(){t("Fetch timeout.")},u)}),l]).then(function(e){return clearTimeout(f),e}).catch(function(e){return console.log(e)})};