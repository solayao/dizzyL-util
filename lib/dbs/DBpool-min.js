"use strict";var _createClass=function(){function e(e,o){for(var n=0;n<o.length;n++){var r=o[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(o,n,r){return n&&e(o.prototype,n),r&&e(o,r),o}}();function _classCallCheck(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}var genericPool=require("generic-pool"),emptyFunc=require("fbjs/lib/emptyFunction"),_require=require("../log/ChalkConsole"),ErrorConsole=_require.ErrorConsole,SuccessConsole=_require.SuccessConsole,DBPool=function(){function e(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:emptyFunc,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return emptyFunc()},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{max:20,min:2};_classCallCheck(this,e);var l={create:o,destroy:function(e){return n(e)}};this.pool=genericPool.createPool(l,r),process.on("unhandledRejection",function(e,o){ErrorConsole("Unhandled Rejection At: Promise ","DBpool"),console.log(o)})}return _createClass(e,[{key:"sqlAction",value:function(){var e=this,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return emptyFunc()},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:__filename;return this.pool.use(function(e){return o(e)}).then(function(o){return SuccessConsole("DBpool Message",n,"Release 1 connection, pool.size is "+e.pool.size+", pool.available is "+e.pool.available),o}).catch(function(o){return SuccessConsole("DBpool Message",n,"Destroy 1 connection, pool.size is "+e.pool.size+", pool.available is "+e.pool.available)})}},{key:"closePool",value:function(){var e=this;this.pool.drain().then(function(){e.pool.clear()})}}]),e}();module.exports=DBPool;