"use strict";var _createClass=function(){function e(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(r,n,t){return n&&e(r.prototype,n),t&&e(r,t),r}}();function _asyncToGenerator(e){return function(){var r=e.apply(this,arguments);return new Promise(function(e,n){return function t(o,a){try{var c=r[o](a),s=c.value}catch(e){return void n(e)}if(!c.done)return Promise.resolve(s).then(function(e){t("next",e)},function(e){t("throw",e)});e(s)}("next")})}}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var HCCrawler=require("headless-chrome-crawler"),_require=require("../log/ChalkConsole"),SuccessConsole=_require.SuccessConsole,ErrorConsole=_require.ErrorConsole,WarningConsole=_require.WarningConsole,DizzyHcCrawler=function(){function e(){_classCallCheck(this,e),this.crawler=null,process.on("unhandledRejection",function(e,r){WarningConsole("UnhandledRejection","DizzyHcCrawler"),console.log(r)})}return _createClass(e,[{key:"create",value:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(r){var n=r.evaluatePage,t=void 0===n?function(){return{}}:n,o=r.onSuccessCB,a=void 0===o?function(e){}:o,c=r.onErrorCB,s=void 0===c?function(){}:c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,HCCrawler.launch({evaluatePage:t,onSuccess:function(e){a(e),SuccessConsole("Crawler Catch HTML",__filename,"[GET "+e.response.status+"] \n\t"+e.response.url+"\n\t"+JSON.stringify(options))}});case 2:this.crawler=e.sent,this.crawler.on("requeststarted",function(e){SuccessConsole("Crawler Catch HTML",__filename,"[HC START] \n\t"+e.url)}),this.crawler.on("requestskipped",function(e){SuccessConsole("Crawler Catch HTML",__filename,"[HC SKIP TO] \n\t"+e.url)}),this.crawler.on("requestfinished",function(e){SuccessConsole("Crawler Catch HTML",__filename,"[HC FINISH] \n\t"+e.url)}),this.crawler.on("requestretried",function(e){WarningConsole("Crawler Catch HTML",__filename,"[HC RETRIED] \n\t"+e.url)}),this.crawler.on("requestfailed",function(e){console.log(e),ErrorConsole("Crawler Catch Error",__filename,"[HC FAILED] \n\t"+JSON.stringify(e)),s()}),this.crawler.on("maxdepthreached",function(){SuccessConsole("Crawler Catch HTML",__filename,"[HC MAXDEPTHREACHED] maxdepthreached")}),this.crawler.on("disconnected",function(){SuccessConsole("Crawler Catch HTML",__filename,"[HC DISCONNECTED] successful")});case 10:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"queue",value:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.crawler.queue(r);case 2:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"close",value:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.crawler.onIdle();case 2:return e.next=4,this.crawler.close();case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}();module.exports=DizzyHcCrawler;