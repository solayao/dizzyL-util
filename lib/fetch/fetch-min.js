"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.myFetch=void 0;var _config=require("./config.json");function _checkStatus(e){if(e.status>=200&&e.status<300)return e;var t=new Error(e.statusText);throw t.response=e,t}function _parseJSON(e){return e?e.json():void 0}function _parseText(e){return e?e.text():void 0}function _fetchWithCORS(e,t,o){return fetch(e,{mode:"cors",credentials:"include",headers:Object.assign({},o)}).then(_checkStatus).then("json"===t?_parseJSON:_parseText).catch(function(e){return console.log(e)})}function _get(e){var t=e.base_url,o=void 0===t?_config.baseUrl:t,n=e.port,r=void 0===n?_config.basePort:n,i=e.path,a=void 0===i?_config.basePath:i,s=e.action,c=void 0===s?"GET":s,u=e.contentType,d=void 0===u?"json":u,v=e.contentHeader,f=void 0===v?{}:v,h=e.url;return _fetchWithCORS(""+(h||o+":"+r)+a+"?action="+c,d,f)}function _getWithQueryParams(e){var t=e.base_url,o=void 0===t?_config.baseUrl:t,n=e.port,r=void 0===n?_config.basePort:n,i=e.path,a=void 0===i?_config.basePath:i,s=e.requestParams,c=void 0===s?{}:s,u=e.action,d=void 0===u?"GET":u,v=e.contentType,f=void 0===v?"json":v,h=e.contentHeader,_=void 0===h?{}:h,p=e.url,g="";for(var b in c)g+=b+"="+encodeURIComponent(c[b])+"&";return _fetchWithCORS(""+(p||o+":"+r)+a+"?"+g+"action="+d,f,_)}function _getWithRequestData(e){var t=e.base_url,o=void 0===t?_config.baseUrl:t,n=e.port,r=void 0===n?_config.basePort:n,i=e.path,a=void 0===i?_config.basePath:i,s=e.requestParams,c=void 0===s?{}:s,u=e.action,d=void 0===u?"GET":u,v=e.contentType,f=void 0===v?"json":v,h=e.contentHeader,_=void 0===h?{}:h,p=e.url;return _fetchWithCORS(""+(p||o+":"+r)+a+"?requestData="+encodeURIComponent(JSON.stringify(c))+"&action="+d,f,_)}function _postWithRequestData(e){var t=e.base_url,o=void 0===t?_config.baseUrl:t,n=e.port,r=void 0===n?_config.basePort:n,i=e.path,a=void 0===i?_config.basePath:i,s=e.requestParams,c=void 0===s?{}:s,u=e.action,d=void 0===u?"POST":u,v=e.contentType,f=void 0===v?"json":v,h=e.contentHeader,_=void 0===h?{}:h,p=e.url;return _fetchWithCORS(""+(p||o+":"+r)+a+"?requestData="+encodeURIComponent(JSON.stringify(c))+"&action="+d,f,_)}var myFetch=exports.myFetch=function(e){var t=e.base_url,o=void 0===t?_config.baseUrl:t,n=e.port,r=void 0===n?_config.basePort:n,i=e.path,a=void 0===i?_config.basePath:i,s=e.timeout,c=void 0===s?12e4:s,u=e.fetchType,d=void 0===u?"get":u,v=e.requestParams,f=void 0===v?{}:v,h=e.contentType,_=void 0===h?"json":h,p=e.url,g=void 0,b=void 0,l={base_url:o,port:r,url:p,path:a,requestParams:f,contentType:_};switch(d){case"get":b=_get(l);break;case"getByQuery":b=_getWithQueryParams(l);break;case"getByRequest":b=_getWithRequestData(l);break;case"post":b=_postWithRequestData(l);break;default:b=fetch(o+":"+r+a,{})}return Promise.race([new Promise(function(e,t){g=setTimeout(function(){t("Fetch timeout.")},c)}),b]).then(function(e){return clearTimeout(g),e}).catch(function(e){return console.log(e)})};